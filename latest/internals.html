<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>How Revise works · Revise.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Revise.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="config.html">Configuration</a></li><li><a class="toctext" href="limitations.html">Limitations</a></li><li class="current"><a class="toctext" href="internals.html">How Revise works</a><ul class="internal"></ul></li><li><a class="toctext" href="user_reference.html">User reference</a></li><li><a class="toctext" href="dev_reference.html">Developer reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="internals.html">How Revise works</a></li></ul><a class="edit-page" href="https://github.com/timholy/Revise.jl/blob/master/docs/src/internals.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>How Revise works</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="How-Revise-works-1" href="#How-Revise-works-1">How Revise works</a></h1><p>Revise is based on the fact that you can change functions even when they are defined in other modules. Here&#39;s an example showing how you do that manually (without using Revise):</p><pre><code class="language-julia">julia&gt; convert(Float64, π)
3.141592653589793

julia&gt; # That&#39;s too hard, let&#39;s make life easier for students

julia&gt; @eval Base convert(::Type{Float64}, x::Irrational{:π}) = 3.0
convert (generic function with 714 methods)

julia&gt; convert(Float64, π)
3.0</code></pre><p>Revise removes some of the tedium of manually copying and pasting code into <code>@eval</code> statements. To decrease the amount of re-JITting required, Revise avoids reloading entire modules; instead, it takes care to <code>eval</code> only the <em>changes</em> in your package(s), much as you would if you were doing it manually. Importantly, changes are detected in a manner that is independent of the specific line numbers in your code, so that you don&#39;t have to re-evaluate just because code moves around within the same file. (However, one unfortunate side effect is that <a href="https://github.com/timholy/Revise.jl/issues/51">line numbers may become inaccurate in backtraces</a>.)</p><p>To accomplish this, Revise uses the following overall strategy:</p><ul><li>add callbacks to Base so that Revise gets notified when new packages are loaded or new files <code>include</code>d</li><li>prepare source-code caches for every new file. These caches will allow Revise to detect changes when files are updated. For precompiled packages this happens on an as-needed basis, using the cached source in the <code>*.ji</code> file. For non-precompiled packages, Revise parses the source for each <code>include</code>d file immediately so that the initial state is known and changes can be detected.</li><li>monitor the file system for changes to any of the dependent files; it immediately appends any updates to a list of file names that need future processing</li><li>intercept the REPL&#39;s backend to ensure that the list of files-to-be-revised gets processed each time you execute a new command at the REPL</li><li>when a revision is triggered, the source file(s) are re-parsed, and a diff between the cached version and the new version is created. <code>eval</code> the diff in the appropriate module(s).</li><li>replace the cached version of each source file with the new version, so that further changes are <code>diff</code>ed against the most recent update.</li></ul><p>You can find more detail about Revise&#39;s inner workings in the <a href="dev_reference.html#Developer-reference-1">Developer reference</a>.</p><footer><hr/><a class="previous" href="limitations.html"><span class="direction">Previous</span><span class="title">Limitations</span></a><a class="next" href="user_reference.html"><span class="direction">Next</span><span class="title">User reference</span></a></footer></article></body></html>

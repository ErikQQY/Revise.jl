<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer reference · Revise.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Revise.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../config/">Configuration</a></li><li><a class="toctext" href="../limitations/">Limitations</a></li><li><a class="toctext" href="../debugging/">Debugging Revise</a></li><li><a class="toctext" href="../internals/">How Revise works</a></li><li><a class="toctext" href="../user_reference/">User reference</a></li><li class="current"><a class="toctext" href>Developer reference</a><ul class="internal"><li><a class="toctext" href="#Internal-global-variables-1">Internal global variables</a></li><li><a class="toctext" href="#Types-1">Types</a></li><li><a class="toctext" href="#Function-reference-1">Function reference</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Developer reference</a></li></ul><a class="edit-page" href="https://github.com/timholy/Revise.jl/blob/master/docs/src/dev_reference.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Developer reference</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Developer-reference-1" href="#Developer-reference-1">Developer reference</a></h1><h2><a class="nav-anchor" id="Internal-global-variables-1" href="#Internal-global-variables-1">Internal global variables</a></h2><h3><a class="nav-anchor" id="Configuration-related-variables-1" href="#Configuration-related-variables-1">Configuration-related variables</a></h3><p>These are set during execution of Revise&#39;s <code>__init__</code> function.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.watching_files" href="#Revise.watching_files"><code>Revise.watching_files</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.watching_files[]</code></pre><p>Returns <code>true</code> if we watch files rather than their containing directory. FreeBSD and NFS-mounted systems should watch files, otherwise we prefer to watch directories.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L17-L23">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.polling_files" href="#Revise.polling_files"><code>Revise.polling_files</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.polling_files[]</code></pre><p>Returns <code>true</code> if we should poll the filesystem for changes to the files that define loaded code. It is preferable to avoid polling, instead relying on operating system notifications via <code>FileWatching.watch_file</code>. However, NFS-mounted filesystems (and perhaps others) do not support file-watching, so for code stored on such filesystems you should turn polling on.</p><p>See the documentation for the <code>JULIA_REVISE_POLL</code> environment variable.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L26-L36">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.tracking_Main_includes" href="#Revise.tracking_Main_includes"><code>Revise.tracking_Main_includes</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.tracking_Main_includes[]</code></pre><p>Returns <code>true</code> if files directly included from the REPL should be tracked. The default is <code>false</code>. See the documentation regarding the <code>JULIA_REVISE_INCLUDE</code> environment variable to customize it.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L54-L60">source</a></section><h3><a class="nav-anchor" id="Path-related-variables-1" href="#Path-related-variables-1">Path-related variables</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.juliadir" href="#Revise.juliadir"><code>Revise.juliadir</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.juliadir</code></pre><p>Constant specifying full path to julia top-level source directory. This should be reliable even for local builds, cross-builds, and binary installs.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L134-L139">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.basesrccache" href="#Revise.basesrccache"><code>Revise.basesrccache</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.basesrccache</code></pre><p>Full path to the running Julia&#39;s cache of source code defining <code>Base</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L116-L120">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.basebuilddir" href="#Revise.basebuilddir"><code>Revise.basebuilddir</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.basebuilddir</code></pre><p>Julia&#39;s top-level directory when Julia was built, as recorded by the entries in <code>Base._included_files</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L123-L128">source</a></section><h3><a class="nav-anchor" id="Internal-state-management-1" href="#Internal-state-management-1">Internal state management</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.pkgdatas" href="#Revise.pkgdatas"><code>Revise.pkgdatas</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.pkgdatas</code></pre><p><code>pkgdatas</code> is the core information that tracks the relationship between source code and julia objects, and allows re-evaluation of code in the proper module scope. It is a dictionary indexed by PkgId: <code>pkgdatas[id]</code> returns a value of type <a href="#Revise.PkgData"><code>Revise.PkgData</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L97-L104">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.watched_files" href="#Revise.watched_files"><code>Revise.watched_files</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.watched_files</code></pre><p>Global variable, <code>watched_files[dirname]</code> returns the collection of files in <code>dirname</code> that we&#39;re monitoring for changes. The returned value has type <a href="#Revise.WatchList"><code>WatchList</code></a>.</p><p>This variable allows us to watch directories rather than files, reducing the burden on the OS.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L77-L85">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.revision_queue" href="#Revise.revision_queue"><code>Revise.revision_queue</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.revision_queue</code></pre><p>Global variable, <code>revision_queue</code> holds <code>(pkgdata,filename)</code> pairs that we need to revise, meaning that these files have changed since we last processed a revision. This list gets populated by callbacks that watch directories for updates.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L88-L94">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.included_files" href="#Revise.included_files"><code>Revise.included_files</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-none">Revise.included_files</code></pre><p>Global variable, <code>included_files</code> gets populated by callbacks we register with <code>include</code>. It&#39;s used to track non-precompiled packages and, optionally, user scripts (see docs on <code>JULIA_REVISE_INCLUDE</code>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L107-L113">source</a></section><h2><a class="nav-anchor" id="Types-1" href="#Types-1">Types</a></h2><pre><code class="language-none">Revise.RelocatableExpr
Revise.DefMap
Revise.SigtMap
Revise.FMMaps
Revise.ModuleExprsSigs
Revise.FileInfo
Revise.PkgData
Revise.WatchList
Revise.Rescheduler
MethodSummary</code></pre><h2><a class="nav-anchor" id="Function-reference-1" href="#Function-reference-1">Function reference</a></h2><h3><a class="nav-anchor" id="Functions-called-during-initialization-of-Revise-1" href="#Functions-called-during-initialization-of-Revise-1">Functions called during initialization of Revise</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.async_steal_repl_backend" href="#Revise.async_steal_repl_backend"><code>Revise.async_steal_repl_backend</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">Revise.async_steal_repl_backend()</code></pre><p>Wait for the REPL to complete its initialization, and then call <a href="#Revise.steal_repl_backend"><code>steal_repl_backend</code></a>. This is necessary because code registered with <code>atreplinit</code> runs before the REPL is initialized, and there is no corresponding way to register code to run after it is complete.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L885-L891">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.steal_repl_backend" href="#Revise.steal_repl_backend"><code>Revise.steal_repl_backend</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">steal_repl_backend(backend = Base.active_repl_backend)</code></pre><p>Replace the REPL&#39;s normal backend with one that calls <a href="../user_reference/#Revise.revise"><code>revise</code></a> before executing any REPL input.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L853-L858">source</a></section><h3><a class="nav-anchor" id="Functions-called-when-you-load-a-new-package-1" href="#Functions-called-when-you-load-a-new-package-1">Functions called when you load a new package</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.watch_package" href="#Revise.watch_package"><code>Revise.watch_package</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">watch_package(id::Base.PkgId)</code></pre><p>Start watching a package for changes to the files that define it. This function gets called via a callback registered with <code>Base.require</code>, at the completion of module-loading by <code>using</code> or <code>import</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/pkgs.jl#L247-L253">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.parse_pkg_files" href="#Revise.parse_pkg_files"><code>Revise.parse_pkg_files</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">parse_pkg_files(id::PkgId)</code></pre><p>This function gets called by <code>watch_package</code> and runs when a package is first loaded. Its job is to organize the files and expressions defining the module so that later we can detect and process revisions.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/pkgs.jl#L101-L107">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.init_watching" href="#Revise.init_watching"><code>Revise.init_watching</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">Revise.init_watching(files)
Revise.init_watching(pkgdata::PkgData, files)</code></pre><p>For every filename in <code>files</code>, monitor the filesystem for updates. When the file is updated, either <a href="#Revise.revise_dir_queued"><code>revise_dir_queued</code></a> or <a href="#Revise.revise_file_queued"><code>revise_file_queued</code></a> will be called.</p><p>Use the <code>pkgdata</code> version if the files are supplied using relative paths.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L365-L374">source</a></section><h3><a class="nav-anchor" id="Monitoring-for-changes-1" href="#Monitoring-for-changes-1">Monitoring for changes</a></h3><p>These functions get called on each directory or file that you monitor for revisions. These block execution until the file(s) are updated, so you should only call them from within an <code>@async</code> block. They work recursively: once an update has been detected and execution resumes, they schedule a revision (see <a href="#Revise.revision_queue"><code>Revise.revision_queue</code></a>) and then call themselves on the same directory or file to wait for the next set of changes.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.revise_dir_queued" href="#Revise.revise_dir_queued"><code>Revise.revise_dir_queued</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">revise_dir_queued(pkgdata::PkgData, dirname)</code></pre><p>Wait for one or more of the files registered in <code>Revise.watched_files[dirname]</code> to be modified, and then queue the corresponding files on <a href="#Revise.revision_queue"><code>Revise.revision_queue</code></a>. This is generally called via a <a href="#Revise.Rescheduler"><code>Rescheduler</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L401-L407">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.revise_file_queued" href="#Revise.revise_file_queued"><code>Revise.revise_file_queued</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">revise_file_queued(pkgdata::PkgData, filename)</code></pre><p>Wait for modifications to <code>filename</code>, and then queue the corresponding files on <a href="#Revise.revision_queue"><code>Revise.revision_queue</code></a>. This is generally called via a <a href="#Revise.Rescheduler"><code>Rescheduler</code></a>.</p><p>This is used only on platforms (like BSD) which cannot use <a href="#Revise.revise_dir_queued"><code>revise_dir_queued</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L433-L440">source</a></section><h3><a class="nav-anchor" id="Evaluating-changes-(revising)-and-computing-diffs-1" href="#Evaluating-changes-(revising)-and-computing-diffs-1">Evaluating changes (revising) and computing diffs</a></h3><pre><code class="language-none">Revise.revise_file_now
Revise.eval_revised</code></pre><h3><a class="nav-anchor" id="Interchange-between-methods-and-signatures-1" href="#Interchange-between-methods-and-signatures-1">Interchange between methods and signatures</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.get_method" href="#Revise.get_method"><code>Revise.get_method</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">method = get_method(sigt)</code></pre><p>Get the method <code>method</code> with signature-type <code>sigt</code>. This is used to provide the method to <code>Base.delete_method</code>. See also <a href="@ref"><code>get_signature</code></a>.</p><p>If <code>sigt</code> does not correspond to a method, returns <code>nothing</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; mymethod(::Int) = 1
mymethod (generic function with 1 method)

julia&gt; mymethod(::AbstractFloat) = 2
mymethod (generic function with 2 methods)

julia&gt; Revise.get_method(Tuple{typeof(mymethod), Int})
mymethod(::Int64) in Main at REPL[0]:1

julia&gt; Revise.get_method(Tuple{typeof(mymethod), Float64})
mymethod(::AbstractFloat) in Main at REPL[1]:1

julia&gt; Revise.get_method(Tuple{typeof(mymethod), Number})
</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L646-L672">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.get_def" href="#Revise.get_def"><code>Revise.get_def</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">success = get_def(method::Method)</code></pre><p>As needed, load the source file necessary for extracting the code defining <code>method</code>. The source-file defining <code>method</code> must be tracked. If it is in Base, this will execute <code>track(Base)</code> if necessary.</p><p>This is a callback function used by <code>CodeTracking.jl</code>&#39;s <code>definition</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/Revise.jl#L689-L697">source</a></section><h3><a class="nav-anchor" id="Parsing-source-code-1" href="#Parsing-source-code-1">Parsing source code</a></h3><pre><code class="language-none">Revise.parse_source
Revise.parse_source!
Revise.parse_expr!
Revise.parse_module!
Revise.funcdef_expr
Revise.get_signature
Revise.get_callexpr
Revise.sig_type_exprs
Revise.sigt2methsig
Revise.argtypeexpr</code></pre><h3><a class="nav-anchor" id="Git-integration-1" href="#Git-integration-1">Git integration</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.git_source" href="#Revise.git_source"><code>Revise.git_source</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">Revise.git_source(file::AbstractString, reference)</code></pre><p>Read the source-text for <code>file</code> from a git commit <code>reference</code>. The reference may be a string, Symbol, or <code>LibGit2.Tree</code>.</p><p><strong>Example:</strong></p><pre><code class="language-none">Revise.git_source(&quot;/path/to/myfile.jl&quot;, &quot;HEAD&quot;)
Revise.git_source(&quot;/path/to/myfile.jl&quot;, :abcd1234)  # by commit SHA</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/git.jl#L54-L64">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.git_files" href="#Revise.git_files"><code>Revise.git_files</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">files = git_files(repo)</code></pre><p>Return the list of files checked into <code>repo</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/git.jl#L36-L40">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Revise.git_repo" href="#Revise.git_repo"><code>Revise.git_repo</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">repo, repo_path = git_repo(path::AbstractString)</code></pre><p>Return the <code>repo::LibGit2.GitRepo</code> containing the file or directory <code>path</code>. <code>path</code> does not necessarily need to be the top-level directory of the repository. Also returns the <code>repo_path</code> of the top-level directory for the repository.</p></div></div><a class="source-link" target="_blank" href="https://github.com/timholy/Revise.jl/blob/0a88466c2f2016b0fe15425af180da9eca5c55a7/src/git.jl#L1-L8">source</a></section><footer><hr/><a class="previous" href="../user_reference/"><span class="direction">Previous</span><span class="title">User reference</span></a></footer></article></body></html>
